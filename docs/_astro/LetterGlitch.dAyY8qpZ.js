import{j as g}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.BVOCwoKb.js";const W=({glitchColors:R=["#195E23","#9E0226","#01520D","#88A000"],className:A="",glitchSpeed:b=50,centerVignette:L=!1,outerVignette:T=!0,smooth:h=!0})=>{const l=a.useRef(null),d=a.useRef(null),s=a.useRef([]),f=a.useRef({columns:0,rows:0}),i=a.useRef(null),y=a.useRef(Date.now()),$=16,x=10,C=20,P=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","!","@","#","$","&","*","(",")","-","_","+","=","/","[","]","{","}",";",":","<",">",",","0","1","2","3","4","5","6","7","8","9","愛","夢","心","火","水","山","海","空","龍","虎","美","力","和","光","音","花","森","風","星","月","日","雨","雪","刀","神","道","魂","忍","侍","武","学","語","友","笑","幸","涙","悲","静","楽","絆","ね","の","ら","も","し","た","き","く","よ","れ","ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","ナ","ニ","ヌ","ネ","ノ"],v=()=>P[Math.floor(Math.random()*P.length)],p=()=>R[Math.floor(Math.random()*R.length)],M=t=>{const r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(r,(e,n,c,u)=>n+n+c+c+u+u);const o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null},S=(t,r,o)=>{const e={r:Math.round(t.r+(r.r-t.r)*o),g:Math.round(t.g+(r.g-t.g)*o),b:Math.round(t.b+(r.b-t.b)*o)};return`rgb(${e.r}, ${e.g}, ${e.b})`},z=(t,r)=>{const o=Math.ceil(t/x),e=Math.ceil(r/C);return{columns:o,rows:e}},j=(t,r)=>{f.current={columns:t,rows:r};const o=t*r;s.current=Array.from({length:o},()=>({char:v(),targetChar:null,opacity:1,fadeProgress:1,color:p(),targetColor:p(),colorProgress:1}))},E=()=>{const t=l.current;if(!t)return;const r=t.parentElement;if(!r)return;const o=window.devicePixelRatio||1,e=r.getBoundingClientRect();t.width=e.width*o,t.height=e.height*o,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,i.current&&i.current.setTransform(o,0,0,o,0,0);const{columns:n,rows:c}=z(e.width,e.height);j(n,c),m()},m=()=>{if(!i.current||s.current.length===0)return;const t=i.current,{width:r,height:o}=l.current.getBoundingClientRect();t.clearRect(0,0,r,o),t.font=`${$}px monospace`,t.textBaseline="top",s.current.forEach((e,n)=>{if(e.opacity<=0)return;const c=n%f.current.columns*x,u=Math.floor(n/f.current.columns)*C;t.fillStyle=e.color,t.globalAlpha=e.opacity,t.fillText(e.char,c,u)}),t.globalAlpha=1},k=()=>{if(!s.current||s.current.length===0)return;const t=Math.max(1,Math.floor(s.current.length*.05));for(let r=0;r<t;r++){const o=Math.floor(Math.random()*s.current.length),e=s.current[o];e&&(e.targetChar=v(),e.fadeProgress=0,e.targetColor=p(),h?e.colorProgress=0:(e.char=e.targetChar,e.targetChar=null,e.opacity=1,e.color=e.targetColor,e.colorProgress=1,e.fadeProgress=1))}},B=()=>{let t=!1;s.current.forEach(r=>{let o=!1;if(r.colorProgress<1){r.colorProgress+=.05,r.colorProgress>1&&(r.colorProgress=1);const e=M(r.color),n=M(r.targetColor);e&&n&&(r.color=S(e,n,r.colorProgress),o=!0)}r.fadeProgress<1&&(r.fadeProgress+=.05,r.fadeProgress>1&&(r.fadeProgress=1),r.fadeProgress<.5?r.opacity=1-r.fadeProgress*2:(r.targetChar&&(r.char=r.targetChar,r.targetChar=null),r.opacity=(r.fadeProgress-.5)*2),o=!0),o&&(t=!0)}),t&&m()},w=()=>{const t=Date.now();t-y.current>=b&&(k(),m(),y.current=t),h&&B(),d.current=requestAnimationFrame(w)};a.useEffect(()=>{const t=l.current;if(!t)return;i.current=t.getContext("2d"),E(),w();let r;const o=()=>{clearTimeout(r),r=setTimeout(()=>{cancelAnimationFrame(d.current),E(),w()},100)};return window.addEventListener("resize",o),()=>{cancelAnimationFrame(d.current),window.removeEventListener("resize",o)}},[b,h]);const D={position:"relative",width:"100%",height:"100%",backgroundColor:"#131313",overflow:"hidden"},F={display:"block",width:"100%",height:"100%"},G={position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",background:"radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,1) 100%)"},I={position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",background:"radial-gradient(circle, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 60%)"};return g.jsxs("div",{style:D,className:A,children:[g.jsx("canvas",{ref:l,style:F}),T&&g.jsx("div",{style:G}),L&&g.jsx("div",{style:I})]})};export{W as default};
